<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>APF Resource Person Dashboard</title>
    <meta name="description"
        content="Productivity dashboard for Resource Persons at Azim Premji Foundation ‚Äî manage school visits, teacher training, observations, reports, and resources.">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>

<body>
    <!-- Password Lock Screen -->
    <div id="lockScreen" class="lock-screen" style="display:none;">
        <div class="lock-container">
            <div class="lock-icon" id="lockIconTap" title="APF Dashboard"><i class="fas fa-shield-alt"></i></div>
            <h1 class="lock-title">APF Dashboard</h1>
            <p class="lock-subtitle" id="lockSubtitle">Enter your password to continue</p>
            <form id="lockForm" onsubmit="handlePasswordSubmit(event)" autocomplete="off">
                <div class="lock-input-group">
                    <div class="lock-input-wrapper">
                        <i class="fas fa-lock"></i>
                        <input type="password" id="lockPassword" placeholder="Password" autofocus required minlength="4">
                        <button type="button" class="lock-eye-btn" onclick="togglePasswordVisibility('lockPassword', this)" tabindex="-1">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>
                <!-- Confirm field shown only during setup -->
                <div class="lock-input-group" id="lockConfirmGroup" style="display:none;">
                    <div class="lock-input-wrapper">
                        <i class="fas fa-lock"></i>
                        <input type="password" id="lockPasswordConfirm" placeholder="Confirm password" minlength="4">
                        <button type="button" class="lock-eye-btn" onclick="togglePasswordVisibility('lockPasswordConfirm', this)" tabindex="-1">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>
                <div class="lock-error" id="lockError"></div>
                <button type="submit" class="btn btn-primary lock-btn" id="lockSubmitBtn">
                    <i class="fas fa-unlock"></i> Unlock
                </button>
            </form>
            <div class="lock-footer" id="lockFooter">
                <div id="lockEmergencyReset" style="display:none;">
                    <p style="color:#ef4444;font-size:12px;margin-bottom:10px;"><i class="fas fa-exclamation-triangle"></i> Emergency reset will <strong>permanently delete ALL data</strong></p>
                    <button type="button" class="btn btn-danger" onclick="resetPasswordPrompt()" style="font-size:12px;padding:8px 16px;width:100%;">
                        <i class="fas fa-trash-alt"></i> Emergency Data Reset
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Sidebar Navigation -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="logo">
                <div class="logo-icon"><i class="fas fa-seedling"></i></div>
                <div class="logo-text">
                    <span class="logo-title">APF Dashboard</span>
                    <span class="logo-subtitle">Resource Person</span>
                </div>
            </div>
        </div>
        <nav class="sidebar-nav">
            <a href="#" class="nav-item active" data-section="dashboard" id="nav-dashboard">
                <i class="fas fa-th-large"></i><span>Dashboard</span>
            </a>
            <a href="#" class="nav-item" data-section="visits" id="nav-visits">
                <i class="fas fa-school"></i><span>School Visits</span>
            </a>
            <a href="#" class="nav-item" data-section="training" id="nav-training">
                <i class="fas fa-chalkboard-teacher"></i><span>Teacher Training</span>
            </a>
            <a href="#" class="nav-item" data-section="observations" id="nav-observations">
                <i class="fas fa-clipboard-check"></i><span>Observations</span>
            </a>
            <a href="#" class="nav-item" data-section="reports" id="nav-reports">
                <i class="fas fa-chart-bar"></i><span>Reports</span>
            </a>
            <a href="#" class="nav-item" data-section="resources" id="nav-resources">
                <i class="fas fa-book-open"></i><span>Resource Library</span>
            </a>
            <div class="nav-divider"></div>
            <a href="#" class="nav-item" data-section="excel" id="nav-excel">
                <i class="fas fa-file-excel"></i><span>Excel Analytics</span>
            </a>
            <a href="#" class="nav-item" data-section="notes" id="nav-notes">
                <i class="fas fa-sticky-note"></i><span>Quick Notes</span>
            </a>
            <a href="#" class="nav-item" data-section="planner" id="nav-planner">
                <i class="fas fa-calendar-week"></i><span>Weekly Planner</span>
            </a>
            <a href="#" class="nav-item" data-section="goals" id="nav-goals">
                <i class="fas fa-bullseye"></i><span>Goal Tracker</span>
            </a>
            <a href="#" class="nav-item" data-section="analytics" id="nav-analytics">
                <i class="fas fa-chart-pie"></i><span>Analytics</span>
            </a>
            <a href="#" class="nav-item" data-section="followups" id="nav-followups">
                <i class="fas fa-tasks"></i><span>Follow-ups</span>
            </a>
            <a href="#" class="nav-item" data-section="ideas" id="nav-ideas">
                <i class="fas fa-lightbulb"></i><span>Idea Tracker</span>
            </a>
            <div class="nav-divider"></div>
            <a href="#" class="nav-item" data-section="schools" id="nav-schools">
                <i class="fas fa-map-marker-alt"></i><span>School Profiles</span>
            </a>
            <a href="#" class="nav-item" data-section="reflections" id="nav-reflections">
                <i class="fas fa-journal-whills"></i><span>Reflections</span>
            </a>
            <a href="#" class="nav-item" data-section="contacts" id="nav-contacts">
                <i class="fas fa-address-book"></i><span>Contacts</span>
            </a>
            <a href="#" class="nav-item" data-section="backup" id="nav-backup">
                <i class="fas fa-shield-alt"></i><span>Backup & Restore</span>
            </a>
        </nav>
        <div class="sidebar-footer">
            <div class="user-info">
                <div class="user-avatar"><i class="fas fa-user"></i></div>
                <div class="user-details">
                    <span class="user-name" id="userName">Resource Person</span>
                    <span class="user-role">Azim Premji Foundation</span>
                </div>
            </div>
        </div>
    </aside>

    <!-- Mobile Header -->
    <header class="mobile-header" id="mobileHeader">
        <button class="menu-toggle" id="menuToggle"><i class="fas fa-bars"></i></button>
        <span class="mobile-title">APF Dashboard</span>
    </header>

    <!-- Overlay for mobile sidebar -->
    <div class="sidebar-overlay" id="sidebarOverlay"></div>

    <!-- Main Content -->
    <main class="main-content" id="mainContent">

        <!-- ==================== DASHBOARD SECTION ==================== -->
        <section class="content-section active" id="section-dashboard">
            <div class="section-header">
                <div>
                    <h1>Welcome back! üëã</h1>
                    <p class="section-subtitle" id="dashboardDate"></p>
                </div>
                <div class="header-actions">
                    <button class="btn btn-outline" onclick="exportAllDataToExcel()">
                        <i class="fas fa-download"></i> Export Data
                    </button>
                    <button class="btn btn-primary" onclick="openQuickAdd()">
                        <i class="fas fa-plus"></i> Quick Add
                    </button>
                </div>
            </div>

            <!-- Metric Cards -->
            <div class="metrics-grid">
                <div class="metric-card metric-visits">
                    <div class="metric-icon"><i class="fas fa-school"></i></div>
                    <div class="metric-info">
                        <span class="metric-value" id="metricTotalVisits">0</span>
                        <span class="metric-label">Total Visits</span>
                    </div>
                    <div class="metric-trend up"><i class="fas fa-arrow-up"></i> This month</div>
                </div>
                <div class="metric-card metric-trainings">
                    <div class="metric-icon"><i class="fas fa-chalkboard-teacher"></i></div>
                    <div class="metric-info">
                        <span class="metric-value" id="metricTrainings">0</span>
                        <span class="metric-label">Trainings Held</span>
                    </div>
                    <div class="metric-trend up"><i class="fas fa-arrow-up"></i> This month</div>
                </div>
                <div class="metric-card metric-observations">
                    <div class="metric-icon"><i class="fas fa-eye"></i></div>
                    <div class="metric-info">
                        <span class="metric-value" id="metricObservations">0</span>
                        <span class="metric-label">Observations</span>
                    </div>
                    <div class="metric-trend neutral"><i class="fas fa-minus"></i> This month</div>
                </div>
                <div class="metric-card metric-schools">
                    <div class="metric-icon"><i class="fas fa-map-marker-alt"></i></div>
                    <div class="metric-info">
                        <span class="metric-value" id="metricSchools">0</span>
                        <span class="metric-label">Schools Covered</span>
                    </div>
                    <div class="metric-trend up"><i class="fas fa-arrow-up"></i> Total</div>
                </div>
            </div>

            <!-- Dashboard Grid -->
            <div class="dashboard-grid">
                <div class="card upcoming-card">
                    <div class="card-header">
                        <h3><i class="fas fa-calendar-alt"></i> Upcoming Visits</h3>
                        <a href="#" class="card-link" onclick="navigateTo('visits')">View All</a>
                    </div>
                    <div class="card-body" id="upcomingVisitsList">
                        <div class="empty-state small">
                            <i class="fas fa-calendar-plus"></i>
                            <p>No upcoming visits scheduled</p>
                        </div>
                    </div>
                </div>
                <div class="card activity-card">
                    <div class="card-header">
                        <h3><i class="fas fa-clock"></i> Recent Activity</h3>
                    </div>
                    <div class="card-body" id="recentActivityList">
                        <div class="empty-state small">
                            <i class="fas fa-history"></i>
                            <p>No recent activity</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Dashboard Charts Row -->
            <div class="dashboard-charts-row">
                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-chart-line"></i> Monthly Activity</h3>
                        <a href="#" class="card-link" onclick="navigateTo('analytics')">Full Analytics</a>
                    </div>
                    <div class="card-body">
                        <canvas id="dashboardMonthlyChart" style="max-height:250px;"></canvas>
                    </div>
                </div>
                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-chart-doughnut"></i> Visit Status</h3>
                    </div>
                    <div class="card-body">
                        <canvas id="dashboardStatusChart" style="max-height:250px;"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <!-- ==================== SCHOOL VISITS SECTION ==================== -->
        <section class="content-section" id="section-visits">
            <div class="section-header">
                <div>
                    <h1><i class="fas fa-school"></i> School Visits</h1>
                    <p class="section-subtitle">Plan, track, and document your school visits</p>
                </div>
                <div class="header-actions">
                    <button class="btn btn-primary" onclick="openVisitModal()">
                        <i class="fas fa-plus"></i> New Visit
                    </button>
                </div>
            </div>

            <!-- Filters -->
            <div class="filter-bar">
                <div class="filter-group">
                    <select id="visitStatusFilter" onchange="renderVisits()">
                        <option value="all">All Status</option>
                        <option value="planned">Planned</option>
                        <option value="completed">Completed</option>
                        <option value="cancelled">Cancelled</option>
                    </select>
                    <input type="text" id="visitSearchInput" placeholder="Search schools..." oninput="renderVisits()">
                </div>
                <div class="view-toggles">
                    <button class="view-btn active" data-view="list" onclick="setVisitView('list')"><i
                            class="fas fa-list"></i></button>
                    <button class="view-btn" data-view="calendar" onclick="setVisitView('calendar')"><i
                            class="fas fa-calendar"></i></button>
                </div>
            </div>

            <!-- Visits List -->
            <div id="visitsContainer" class="visits-list">
                <div class="empty-state">
                    <i class="fas fa-school"></i>
                    <h3>No school visits yet</h3>
                    <p>Start planning your visits by clicking "New Visit"</p>
                </div>
            </div>
        </section>

        <!-- ==================== TEACHER TRAINING SECTION ==================== -->
        <section class="content-section" id="section-training">
            <div class="section-header">
                <div>
                    <h1><i class="fas fa-chalkboard-teacher"></i> Teacher Training</h1>
                    <p class="section-subtitle">Manage workshops, sessions, and training programs</p>
                </div>
                <div class="header-actions">
                    <button class="btn btn-primary" onclick="openTrainingModal()">
                        <i class="fas fa-plus"></i> New Training
                    </button>
                </div>
            </div>

            <div class="filter-bar">
                <div class="filter-group">
                    <select id="trainingStatusFilter" onchange="renderTrainings()">
                        <option value="all">All Status</option>
                        <option value="upcoming">Upcoming</option>
                        <option value="completed">Completed</option>
                        <option value="ongoing">Ongoing</option>
                    </select>
                    <input type="text" id="trainingSearchInput" placeholder="Search trainings..."
                        oninput="renderTrainings()">
                </div>
            </div>

            <div id="trainingsContainer" class="trainings-grid">
                <div class="empty-state">
                    <i class="fas fa-chalkboard-teacher"></i>
                    <h3>No training sessions yet</h3>
                    <p>Create your first training by clicking "New Training"</p>
                </div>
            </div>
        </section>

        <!-- ==================== OBSERVATIONS SECTION ==================== -->
        <section class="content-section" id="section-observations">
            <div class="section-header">
                <div>
                    <h1><i class="fas fa-clipboard-check"></i> Observation Notes</h1>
                    <p class="section-subtitle">Capture classroom observations and feedback</p>
                </div>
                <div class="header-actions">
                    <button class="btn btn-primary" onclick="openObservationModal()">
                        <i class="fas fa-plus"></i> New Observation
                    </button>
                </div>
            </div>

            <div class="filter-bar">
                <div class="filter-group">
                    <select id="observationSubjectFilter" onchange="renderObservations()">
                        <option value="all">All Subjects</option>
                        <option value="Mathematics">Mathematics</option>
                        <option value="Science">Science</option>
                        <option value="Language">Language</option>
                        <option value="Social Science">Social Science</option>
                        <option value="EVS">EVS</option>
                        <option value="Other">Other</option>
                    </select>
                    <input type="text" id="observationSearchInput" placeholder="Search observations..."
                        oninput="renderObservations()">
                </div>
            </div>

            <div id="observationsContainer" class="observations-list">
                <div class="empty-state">
                    <i class="fas fa-clipboard-check"></i>
                    <h3>No observations recorded</h3>
                    <p>Start documenting classroom observations</p>
                </div>
            </div>
        </section>

        <!-- ==================== REPORTS SECTION ==================== -->
        <section class="content-section" id="section-reports">
            <div class="section-header">
                <div>
                    <h1><i class="fas fa-chart-bar"></i> Reports</h1>
                    <p class="section-subtitle">Generate and view summary reports</p>
                </div>
            </div>

            <div class="reports-controls">
                <div class="report-type-selector">
                    <button class="report-type-btn active" data-type="monthly" onclick="setReportType('monthly')">
                        <i class="fas fa-calendar-alt"></i> Monthly Report
                    </button>
                    <button class="report-type-btn" data-type="school" onclick="setReportType('school')">
                        <i class="fas fa-school"></i> School Report
                    </button>
                    <button class="report-type-btn" data-type="summary" onclick="setReportType('summary')">
                        <i class="fas fa-chart-pie"></i> Summary
                    </button>
                </div>
                <div class="report-filters">
                    <select id="reportMonthFilter">
                        <option value="0">January</option>
                        <option value="1">February</option>
                        <option value="2">March</option>
                        <option value="3">April</option>
                        <option value="4">May</option>
                        <option value="5">June</option>
                        <option value="6">July</option>
                        <option value="7">August</option>
                        <option value="8">September</option>
                        <option value="9">October</option>
                        <option value="10">November</option>
                        <option value="11">December</option>
                    </select>
                    <select id="reportYearFilter"></select>
                    <button class="btn btn-primary" onclick="generateReport()">
                        <i class="fas fa-cog"></i> Generate
                    </button>
                    <button class="btn btn-outline" onclick="printReport()">
                        <i class="fas fa-print"></i> Print
                    </button>
                </div>
            </div>

            <div id="reportOutput" class="report-output">
                <div class="empty-state">
                    <i class="fas fa-chart-bar"></i>
                    <h3>Select report type and generate</h3>
                    <p>Choose a report type above and click Generate</p>
                </div>
            </div>
        </section>

        <!-- ==================== RESOURCE LIBRARY SECTION ==================== -->
        <section class="content-section" id="section-resources">
            <div class="section-header">
                <div>
                    <h1><i class="fas fa-book-open"></i> Resource Library</h1>
                    <p class="section-subtitle">Organize teaching and learning materials</p>
                </div>
                <div class="header-actions">
                    <button class="btn btn-primary" onclick="openResourceModal()">
                        <i class="fas fa-plus"></i> Add Resource
                    </button>
                </div>
            </div>

            <div class="filter-bar">
                <div class="filter-group">
                    <select id="resourceTypeFilter" onchange="renderResources()">
                        <option value="all">All Types</option>
                        <option value="Worksheet">Worksheet</option>
                        <option value="Lesson Plan">Lesson Plan</option>
                        <option value="Activity">Activity</option>
                        <option value="Reference">Reference Material</option>
                        <option value="TLM">Teaching-Learning Material</option>
                        <option value="Video">Video</option>
                        <option value="Other">Other</option>
                    </select>
                    <select id="resourceSubjectFilter" onchange="renderResources()">
                        <option value="all">All Subjects</option>
                        <option value="Mathematics">Mathematics</option>
                        <option value="Science">Science</option>
                        <option value="Language">Language</option>
                        <option value="Social Science">Social Science</option>
                        <option value="EVS">EVS</option>
                        <option value="Other">Other</option>
                    </select>
                    <input type="text" id="resourceSearchInput" placeholder="Search resources..."
                        oninput="renderResources()">
                </div>
            </div>

            <div id="resourcesContainer" class="resources-grid">
                <div class="empty-state">
                    <i class="fas fa-book-open"></i>
                    <h3>No resources added yet</h3>
                    <p>Build your resource library by clicking "Add Resource"</p>
                </div>
            </div>
        </section>

        <!-- ==================== EXCEL ANALYTICS SECTION ==================== -->
        <section class="content-section" id="section-excel">
            <div class="section-header">
                <div>
                    <h1><i class="fas fa-file-excel"></i> Excel Analytics</h1>
                    <p class="section-subtitle">Upload any Excel file and get instant dashboard visuals & insights</p>
                </div>
                <div class="header-actions">
                    <button class="btn btn-outline" onclick="clearExcelData()" id="clearExcelBtn" style="display:none;">
                        <i class="fas fa-trash"></i> Clear
                    </button>
                </div>
            </div>

            <!-- Upload Area -->
            <div class="excel-upload-zone" id="excelUploadZone">
                <div class="upload-content">
                    <div class="upload-icon-wrapper">
                        <i class="fas fa-cloud-upload-alt"></i>
                    </div>
                    <h3>Drop your Excel file here</h3>
                    <p>or click to browse ‚Äî supports .xlsx, .xls, .csv files</p>
                    <button class="btn btn-primary" onclick="document.getElementById('excelFileInput').click()">
                        <i class="fas fa-folder-open"></i> Choose File
                    </button>
                    <input type="file" id="excelFileInput" accept=".xlsx,.xls,.csv" style="display:none"
                        onchange="handleExcelUpload(event)">
                </div>
            </div>

            <!-- Sheet Selector (shown after upload) -->
            <div class="excel-sheet-selector" id="excelSheetSelector" style="display:none;">
                <div class="sheet-info">
                    <i class="fas fa-file-excel" style="color:var(--success);font-size:20px"></i>
                    <div>
                        <strong id="excelFileName">file.xlsx</strong>
                        <span id="excelFileInfo" class="text-muted"></span>
                    </div>
                </div>
                <div class="sheet-tabs" id="excelSheetTabs"></div>
            </div>

            <!-- Excel Dashboard -->
            <div id="excelDashboard" style="display:none;">
                <!-- Summary Stats -->
                <div class="excel-summary-bar" id="excelSummaryBar"></div>

                <!-- Analysis Tabs -->
                <div class="excel-analysis-tabs">
                    <button class="analysis-tab active" onclick="switchAnalysisTab('auto')" data-tab="auto">
                        <i class="fas fa-magic"></i> Auto Analysis
                    </button>
                    <button class="analysis-tab" onclick="switchAnalysisTab('custom')" data-tab="custom">
                        <i class="fas fa-sliders-h"></i> Custom Charts
                    </button>
                    <button class="analysis-tab" onclick="switchAnalysisTab('pivot')" data-tab="pivot">
                        <i class="fas fa-th"></i> Pivot Analysis
                    </button>
                    <button class="analysis-tab" onclick="switchAnalysisTab('quality')" data-tab="quality">
                        <i class="fas fa-shield-alt"></i> Data Quality
                    </button>
                </div>

                <!-- TAB: Auto Analysis -->
                <div class="analysis-panel active" id="panel-auto">
                    <div class="excel-insights-panel" id="excelInsightsPanel"></div>
                    <div class="excel-charts-grid" id="excelChartsGrid"></div>
                </div>

                <!-- TAB: Custom Chart Builder -->
                <div class="analysis-panel" id="panel-custom">
                    <div class="card">
                        <div class="card-header">
                            <h3><i class="fas fa-paint-brush"></i> Build Your Own Chart</h3>
                        </div>
                        <div class="card-body">
                            <div class="chart-builder-controls">
                                <div class="builder-row">
                                    <div class="form-group">
                                        <label>Chart Type</label>
                                        <select id="customChartType">
                                            <option value="bar">üìä Bar Chart</option>
                                            <option value="line">üìà Line Chart</option>
                                            <option value="pie">ü•ß Pie / Doughnut</option>
                                            <option value="radar">üï∏Ô∏è Radar Chart</option>
                                            <option value="scatter">üîµ Scatter Plot</option>
                                            <option value="histogram">üìä Histogram</option>
                                            <option value="polarArea">üéØ Polar Area</option>
                                            <option value="horizontalBar">üìä Horizontal Bar</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label>X-Axis / Labels</label>
                                        <select id="customChartX"></select>
                                    </div>
                                    <div class="form-group">
                                        <label>Y-Axis / Values</label>
                                        <select id="customChartY"></select>
                                    </div>
                                    <div class="form-group">
                                        <label>Aggregation</label>
                                        <select id="customChartAgg">
                                            <option value="sum">Sum</option>
                                            <option value="average">Average</option>
                                            <option value="count">Count</option>
                                            <option value="min">Min</option>
                                            <option value="max">Max</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="builder-row">
                                    <div class="form-group">
                                        <label>Group By (optional)</label>
                                        <select id="customChartGroup">
                                            <option value="">‚Äî None ‚Äî</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label>Top N</label>
                                        <select id="customChartTopN">
                                            <option value="10">Top 10</option>
                                            <option value="15">Top 15</option>
                                            <option value="20" selected>Top 20</option>
                                            <option value="50">Top 50</option>
                                            <option value="all">All</option>
                                        </select>
                                    </div>
                                    <div class="form-group" style="display:flex;align-items:flex-end;">
                                        <button class="btn btn-primary" onclick="buildCustomChart()" style="width:100%">
                                            <i class="fas fa-chart-bar"></i> Generate Chart
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="customChartOutput" style="margin-top:20px;"></div>
                </div>

                <!-- TAB: Pivot Analysis -->
                <div class="analysis-panel" id="panel-pivot">
                    <div class="card">
                        <div class="card-header">
                            <h3><i class="fas fa-th"></i> Pivot Table Builder</h3>
                        </div>
                        <div class="card-body">
                            <div class="chart-builder-controls">
                                <div class="builder-row">
                                    <div class="form-group">
                                        <label>Row (Group By)</label>
                                        <select id="pivotRow"></select>
                                    </div>
                                    <div class="form-group">
                                        <label>Value Column</label>
                                        <select id="pivotValue"></select>
                                    </div>
                                    <div class="form-group">
                                        <label>Aggregation</label>
                                        <select id="pivotAgg">
                                            <option value="sum">Sum</option>
                                            <option value="average">Average</option>
                                            <option value="count">Count</option>
                                            <option value="min">Min</option>
                                            <option value="max">Max</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label>Column Split (optional)</label>
                                        <select id="pivotCol">
                                            <option value="">‚Äî None ‚Äî</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="builder-row">
                                    <div class="form-group" style="display:flex;align-items:flex-end;">
                                        <button class="btn btn-primary" onclick="buildPivotTable()" style="width:100%">
                                            <i class="fas fa-table"></i> Generate Pivot
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="pivotOutput" style="margin-top:20px;"></div>
                </div>

                <!-- TAB: Data Quality -->
                <div class="analysis-panel" id="panel-quality">
                    <div id="dataQualityOutput"></div>
                </div>

                <!-- Data Table Preview -->
                <div class="card" style="margin-top:20px;">
                    <div class="card-header">
                        <h3><i class="fas fa-table"></i> Data Preview</h3>
                        <span class="text-muted" id="excelRowCount"></span>
                    </div>
                    <div class="card-body" style="max-height:500px;overflow:auto;padding:0;">
                        <div id="excelTableContainer"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ==================== QUICK NOTES SECTION ==================== -->
        <section class="content-section" id="section-notes">
            <div class="section-header">
                <div>
                    <h1><i class="fas fa-sticky-note"></i> Quick Notes</h1>
                    <p class="section-subtitle">Jot down ideas, reminders, and to-do items</p>
                </div>
                <div class="header-actions">
                    <button class="btn btn-primary" onclick="addNewNote()">
                        <i class="fas fa-plus"></i> New Note
                    </button>
                </div>
            </div>

            <div id="notesContainer" class="notes-grid">
                <div class="empty-state">
                    <i class="fas fa-sticky-note"></i>
                    <h3>No notes yet</h3>
                    <p>Click "New Note" to start jotting things down</p>
                </div>
            </div>
        </section>

        <!-- ==================== WEEKLY PLANNER SECTION ==================== -->
        <section class="content-section" id="section-planner">
            <div class="section-header">
                <div>
                    <h1><i class="fas fa-calendar-week"></i> Weekly Planner</h1>
                    <p class="section-subtitle">Plan your school visits, trainings, and field work for the week</p>
                </div>
                <div class="header-actions">
                    <button class="btn btn-outline" onclick="navigatePlannerWeek(-1)">
                        <i class="fas fa-chevron-left"></i> Prev Week
                    </button>
                    <button class="btn btn-outline" onclick="navigatePlannerWeek(0)">
                        <i class="fas fa-calendar-day"></i> This Week
                    </button>
                    <button class="btn btn-outline" onclick="navigatePlannerWeek(1)">
                        Next Week <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
            </div>

            <div class="planner-week-header" id="plannerWeekHeader"></div>
            <div class="planner-grid" id="plannerGrid"></div>
        </section>

        <!-- ==================== GOAL TRACKER SECTION ==================== -->
        <section class="content-section" id="section-goals">
            <div class="section-header">
                <div>
                    <h1><i class="fas fa-bullseye"></i> Goal Tracker</h1>
                    <p class="section-subtitle">Set and track your monthly targets for field activities</p>
                </div>
                <div class="header-actions">
                    <select id="goalMonth" class="filter-select" onchange="renderGoals()"></select>
                    <button class="btn btn-primary" onclick="saveGoalTargets()">
                        <i class="fas fa-save"></i> Save Targets
                    </button>
                </div>
            </div>

            <!-- Goal Progress Cards -->
            <div class="goals-progress-grid" id="goalsProgressGrid"></div>

            <!-- Goal Inputs -->
            <div class="card" style="margin-top:20px;">
                <div class="card-header">
                    <h3><i class="fas fa-sliders-h"></i> Set Monthly Targets</h3>
                </div>
                <div class="card-body">
                    <div class="goal-targets-form" id="goalTargetsForm">
                        <div class="goal-target-row">
                            <label><i class="fas fa-school"></i> School Visits</label>
                            <input type="number" id="goalVisits" min="0" max="100" value="15"
                                placeholder="Target visits">
                        </div>
                        <div class="goal-target-row">
                            <label><i class="fas fa-chalkboard-teacher"></i> Training Sessions</label>
                            <input type="number" id="goalTrainings" min="0" max="50" value="4"
                                placeholder="Target trainings">
                        </div>
                        <div class="goal-target-row">
                            <label><i class="fas fa-clipboard-check"></i> Observations</label>
                            <input type="number" id="goalObservations" min="0" max="100" value="10"
                                placeholder="Target observations">
                        </div>
                        <div class="goal-target-row">
                            <label><i class="fas fa-users"></i> Teachers Reached</label>
                            <input type="number" id="goalTeachers" min="0" max="500" value="50"
                                placeholder="Target teachers">
                        </div>
                        <div class="goal-target-row">
                            <label><i class="fas fa-book-open"></i> Resources Created</label>
                            <input type="number" id="goalResources" min="0" max="50" value="5"
                                placeholder="Target resources">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Monthly Activity Chart -->
            <div class="card" style="margin-top:20px;">
                <div class="card-header">
                    <h3><i class="fas fa-chart-line"></i> Monthly Activity Trend</h3>
                </div>
                <div class="card-body">
                    <canvas id="goalTrendChart" style="min-height:300px;"></canvas>
                </div>
            </div>
        </section>

        <!-- ==================== ANALYTICS SECTION ==================== -->
        <section class="content-section" id="section-analytics">
            <div class="section-header">
                <div>
                    <h1><i class="fas fa-chart-pie"></i> Analytics</h1>
                    <p class="section-subtitle">Deep analysis of your field activities, coverage, and impact</p>
                </div>
                <div class="header-actions">
                    <select id="analyticsRange" class="filter-select" onchange="renderAnalytics()">
                        <option value="all">All Time</option>
                        <option value="month" selected>This Month</option>
                        <option value="quarter">This Quarter</option>
                        <option value="year">This Year</option>
                    </select>
                </div>
            </div>

            <!-- Smart Insights -->
            <div class="analytics-insights" id="analyticsInsightsPanel"></div>

            <!-- Key Metrics Row -->
            <div class="analytics-kpi-grid" id="analyticsKpiGrid"></div>

            <!-- Charts Grid -->
            <div class="analytics-charts-grid">
                <div class="card">
                    <div class="card-header"><h3><i class="fas fa-chart-doughnut"></i> Visit Purpose Breakdown</h3></div>
                    <div class="card-body"><canvas id="chartVisitPurpose" style="max-height:320px;"></canvas></div>
                </div>
                <div class="card">
                    <div class="card-header"><h3><i class="fas fa-chart-bar"></i> School Coverage</h3></div>
                    <div class="card-body"><canvas id="chartSchoolCoverage" style="max-height:320px;"></canvas></div>
                </div>
                <div class="card">
                    <div class="card-header"><h3><i class="fas fa-star-half-alt"></i> Average Observation Ratings</h3></div>
                    <div class="card-body"><canvas id="chartObsRatings" style="max-height:320px;"></canvas></div>
                </div>
                <div class="card">
                    <div class="card-header"><h3><i class="fas fa-book"></i> Subject Distribution</h3></div>
                    <div class="card-body"><canvas id="chartSubjectDist" style="max-height:320px;"></canvas></div>
                </div>
                <div class="card">
                    <div class="card-header"><h3><i class="fas fa-users"></i> Training ‚Äî Teachers Reached</h3></div>
                    <div class="card-body"><canvas id="chartTrainingImpact" style="max-height:320px;"></canvas></div>
                </div>
                <div class="card">
                    <div class="card-header"><h3><i class="fas fa-calendar-check"></i> Weekly Activity Heatmap</h3></div>
                    <div class="card-body"><canvas id="chartWeeklyHeatmap" style="max-height:320px;"></canvas></div>
                </div>
            </div>

            <!-- Activity Timeline -->
            <div class="card" style="margin-top:20px;">
                <div class="card-header">
                    <h3><i class="fas fa-stream"></i> Activity Timeline</h3>
                    <span class="text-muted" id="timelineCount"></span>
                </div>
                <div class="card-body" id="activityTimeline" style="max-height:500px;overflow-y:auto;"></div>
            </div>
        </section>

        <!-- ==================== FOLLOW-UPS SECTION ==================== -->
        <section class="content-section" id="section-followups">
            <div class="section-header">
                <div>
                    <h1><i class="fas fa-tasks"></i> Follow-up Tracker</h1>
                    <p class="section-subtitle">Track pending follow-ups from school visits and observations</p>
                </div>
                <div class="header-actions">
                    <select id="followupFilter" class="filter-select" onchange="renderFollowups()">
                        <option value="pending">Pending</option>
                        <option value="done">Completed</option>
                        <option value="all">All</option>
                    </select>
                </div>
            </div>
            <div class="followup-stats" id="followupStats"></div>
            <div id="followupsContainer" class="followups-list"></div>
        </section>

        <!-- ==================== IDEA TRACKER SECTION ==================== -->
        <section class="content-section" id="section-ideas">
            <div class="section-header">
                <div>
                    <h1><i class="fas fa-lightbulb"></i> Idea Tracker</h1>
                    <p class="section-subtitle">Capture, organize & nurture your best ideas ‚ú®</p>
                </div>
                <div class="header-actions">
                    <button class="btn btn-primary" onclick="openIdeaModal()">
                        <i class="fas fa-plus"></i> New Idea
                    </button>
                </div>
            </div>

            <!-- Idea Stats -->
            <div class="idea-stats-row" id="ideaStats"></div>

            <!-- View Toggle & Filters -->
            <div class="idea-toolbar">
                <div class="idea-view-toggle">
                    <button class="view-btn active" data-view="board" onclick="setIdeaView('board')">
                        <i class="fas fa-columns"></i> Board
                    </button>
                    <button class="view-btn" data-view="grid" onclick="setIdeaView('grid')">
                        <i class="fas fa-th"></i> Grid
                    </button>
                    <button class="view-btn" data-view="list" onclick="setIdeaView('list')">
                        <i class="fas fa-list"></i> List
                    </button>
                </div>
                <div class="idea-filters">
                    <select id="ideaCategoryFilter" class="filter-select" onchange="renderIdeas()">
                        <option value="all">All Categories</option>
                        <option value="Teaching">üéì Teaching</option>
                        <option value="Activity">üé® Activity</option>
                        <option value="Training">üìã Training</option>
                        <option value="Resource">üìö Resource</option>
                        <option value="Community">ü§ù Community</option>
                        <option value="Tech">üíª Tech</option>
                        <option value="Other">üí° Other</option>
                    </select>
                    <input type="text" id="ideaSearchInput" class="filter-input" placeholder="Search ideas..." oninput="renderIdeas()">
                </div>
            </div>

            <!-- Idea Board / Grid / List Container -->
            <div id="ideasContainer"></div>
        </section>

        <!-- ==================== SCHOOL PROFILES SECTION ==================== -->
        <section class="content-section" id="section-schools">
            <div class="section-header">
                <div>
                    <h1><i class="fas fa-map-marker-alt"></i> School Profiles</h1>
                    <p class="section-subtitle">Complete history of every school you work with</p>
                </div>
                <div class="header-actions">
                    <input type="text" id="schoolSearchInput" class="filter-input" placeholder="Search schools..." oninput="renderSchoolProfiles()">
                </div>
            </div>
            <div class="school-summary-stats" id="schoolSummaryStats"></div>
            <div id="schoolProfilesContainer"></div>
            <!-- School Detail View (hidden by default) -->
            <div id="schoolDetailView" style="display:none;"></div>
        </section>

        <!-- ==================== REFLECTIONS SECTION ==================== -->
        <section class="content-section" id="section-reflections">
            <div class="section-header">
                <div>
                    <h1><i class="fas fa-journal-whills"></i> Reflections Journal</h1>
                    <p class="section-subtitle">Monthly reflections on your practice and growth</p>
                </div>
                <div class="header-actions">
                    <select id="reflectionMonthFilter" class="filter-select" onchange="renderReflections()"></select>
                    <button class="btn btn-primary" onclick="openReflectionModal()">
                        <i class="fas fa-plus"></i> New Reflection
                    </button>
                </div>
            </div>
            <div id="reflectionsContainer"></div>
        </section>

        <!-- ==================== CONTACTS SECTION ==================== -->
        <section class="content-section" id="section-contacts">
            <div class="section-header">
                <div>
                    <h1><i class="fas fa-address-book"></i> Contact Directory</h1>
                    <p class="section-subtitle">Key contacts for your field work</p>
                </div>
                <div class="header-actions">
                    <select id="contactRoleFilter" class="filter-select" onchange="renderContacts()">
                        <option value="all">All Roles</option>
                        <option value="Head Master">Head Master</option>
                        <option value="Teacher">Teacher</option>
                        <option value="BEO">BEO</option>
                        <option value="DIET Faculty">DIET Faculty</option>
                        <option value="CRP">CRP</option>
                        <option value="Fellow RP">Fellow RP</option>
                        <option value="Mentor">Mentor</option>
                        <option value="Other">Other</option>
                    </select>
                    <input type="text" id="contactSearchInput" class="filter-input" placeholder="Search contacts..." oninput="renderContacts()">
                    <button class="btn btn-primary" onclick="openContactModal()">
                        <i class="fas fa-plus"></i> Add Contact
                    </button>
                </div>
            </div>
            <div class="contact-stats" id="contactStats"></div>
            <div id="contactsContainer"></div>
        </section>

        <!-- ==================== BACKUP & RESTORE SECTION ==================== -->
        <section class="content-section" id="section-backup">
            <div class="section-header">
                <div>
                    <h1><i class="fas fa-shield-alt"></i> Backup & Restore</h1>
                    <p class="section-subtitle">Protect your data ‚Äî download backups and restore anytime</p>
                </div>
            </div>
            <div class="backup-grid">
                <div class="backup-card backup-download">
                    <div class="backup-icon"><i class="fas fa-cloud-download-alt"></i></div>
                    <h3>Download Backup</h3>
                    <p>Export all your data as a JSON file. Keep it safe on your device or cloud storage.</p>
                    <div class="backup-info" id="backupInfo"></div>
                    <button class="btn btn-primary" onclick="downloadBackup()">
                        <i class="fas fa-download"></i> Download Backup
                    </button>
                </div>
                <div class="backup-card backup-restore">
                    <div class="backup-icon" style="background:linear-gradient(135deg, #10b981, #059669);"><i class="fas fa-cloud-upload-alt"></i></div>
                    <h3>Restore from Backup</h3>
                    <p>Upload a previously downloaded backup file to restore all your data.</p>
                    <div class="backup-warning">
                        <i class="fas fa-exclamation-triangle"></i>
                        <span>This will replace ALL current data. Make sure to download a backup first!</span>
                    </div>
                    <label class="btn btn-outline backup-upload-btn">
                        <i class="fas fa-upload"></i> Choose Backup File
                        <input type="file" accept=".json" onchange="restoreBackup(event)" style="display:none">
                    </label>
                </div>
                <div class="backup-card backup-excel">
                    <div class="backup-icon" style="background:linear-gradient(135deg, #3b82f6, #1d4ed8);"><i class="fas fa-file-excel"></i></div>
                    <h3>Export to Excel</h3>
                    <p>Download all your data as an organized Excel spreadsheet for reporting.</p>
                    <button class="btn btn-primary" onclick="exportAllDataToExcel()" style="background:#3b82f6;">
                        <i class="fas fa-file-export"></i> Export Excel
                    </button>
                </div>
                <div class="backup-card backup-danger">
                    <div class="backup-icon" style="background:linear-gradient(135deg, #ef4444, #b91c1c);"><i class="fas fa-trash-alt"></i></div>
                    <h3>Reset All Data</h3>
                    <p>Permanently delete all data and start fresh. This cannot be undone.</p>
                    <button class="btn btn-danger" onclick="resetAllData()">
                        <i class="fas fa-exclamation-triangle"></i> Reset Everything
                    </button>
                </div>
                <div class="backup-card backup-password">
                    <div class="backup-icon" style="background:linear-gradient(135deg, #f59e0b, #d97706);"><i class="fas fa-key"></i></div>
                    <h3>Password Protection</h3>
                    <p id="passwordStatusText">Protect your dashboard with a password. Data stays locked until you enter it.</p>
                    <div class="password-status" id="passwordStatus"></div>
                    <div id="passwordActions">
                        <button class="btn btn-primary" id="btnSetPassword" onclick="openPasswordSetup()" style="background:#f59e0b;">
                            <i class="fas fa-lock"></i> Set Password
                        </button>
                        <button class="btn btn-outline" id="btnChangePassword" onclick="openPasswordChange()" style="display:none;">
                            <i class="fas fa-key"></i> Change Password
                        </button>
                        <button class="btn btn-danger" id="btnRemovePassword" onclick="removePassword()" style="display:none;margin-top:8px;">
                            <i class="fas fa-unlock"></i> Remove Password
                        </button>
                    </div>
                    <div class="password-settings" id="passwordAutoLockSetting" style="display:none;">
                        <label for="autoLockTime" style="color:var(--text-secondary);font-size:13px;margin-top:12px;display:block;">
                            <i class="fas fa-clock"></i> Auto-lock after inactivity:
                        </label>
                        <select id="autoLockTime" onchange="setAutoLockTime(this.value)" style="margin-top:6px;width:100%;padding:8px 12px;background:var(--bg-input);color:var(--text-primary);border:1px solid var(--border);border-radius:8px;font-size:13px;">
                            <option value="0">Never</option>
                            <option value="5">5 minutes</option>
                            <option value="15">15 minutes</option>
                            <option value="30">30 minutes</option>
                            <option value="60">1 hour</option>
                        </select>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <!-- ==================== MODALS ==================== -->

    <!-- Visit Modal -->
    <div class="modal-overlay" id="visitModal">
        <div class="modal">
            <div class="modal-header">
                <h2 id="visitModalTitle"><i class="fas fa-school"></i> New School Visit</h2>
                <button class="modal-close" onclick="closeModal('visitModal')"><i class="fas fa-times"></i></button>
            </div>
            <form id="visitForm" onsubmit="saveVisit(event)">
                <div class="modal-body">
                    <input type="hidden" id="visitId">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="visitSchool">School Name *</label>
                            <input type="text" id="visitSchool" required
                                placeholder="e.g. Government Primary School, Anekal">
                        </div>
                        <div class="form-group">
                            <label for="visitBlock">Block / Cluster</label>
                            <input type="text" id="visitBlock" placeholder="e.g. Anekal Block">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="visitDate">Visit Date *</label>
                            <input type="date" id="visitDate" required>
                        </div>
                        <div class="form-group">
                            <label for="visitStatus">Status</label>
                            <select id="visitStatus">
                                <option value="planned">Planned</option>
                                <option value="completed">Completed</option>
                                <option value="cancelled">Cancelled</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="visitPurpose">Purpose of Visit</label>
                        <select id="visitPurpose">
                            <option value="Classroom Observation">Classroom Observation</option>
                            <option value="Teacher Support">Teacher Support</option>
                            <option value="Workshop Facilitation">Workshop Facilitation</option>
                            <option value="Material Distribution">Material Distribution</option>
                            <option value="Meeting with HM">Meeting with Head Master</option>
                            <option value="Follow-up">Follow-up Visit</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="visitNotes">Notes / Key Observations</label>
                        <textarea id="visitNotes" rows="4"
                            placeholder="Describe your observations, discussions, and action points..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="visitFollowUp">Follow-up Actions</label>
                        <textarea id="visitFollowUp" rows="2"
                            placeholder="List any follow-up actions required..."></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-ghost" onclick="closeModal('visitModal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Visit</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Training Modal -->
    <div class="modal-overlay" id="trainingModal">
        <div class="modal">
            <div class="modal-header">
                <h2 id="trainingModalTitle"><i class="fas fa-chalkboard-teacher"></i> New Training</h2>
                <button class="modal-close" onclick="closeModal('trainingModal')"><i class="fas fa-times"></i></button>
            </div>
            <form id="trainingForm" onsubmit="saveTraining(event)">
                <div class="modal-body">
                    <input type="hidden" id="trainingId">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="trainingTitle">Training Title *</label>
                            <input type="text" id="trainingTitle" required
                                placeholder="e.g. Activity-Based Learning Workshop">
                        </div>
                        <div class="form-group">
                            <label for="trainingTopic">Topic / Theme</label>
                            <input type="text" id="trainingTopic" placeholder="e.g. Foundational Numeracy">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="trainingDate">Date *</label>
                            <input type="date" id="trainingDate" required>
                        </div>
                        <div class="form-group">
                            <label for="trainingDuration">Duration (hours)</label>
                            <input type="number" id="trainingDuration" min="0.5" step="0.5" value="3"
                                placeholder="e.g. 3">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="trainingVenue">Venue</label>
                            <input type="text" id="trainingVenue" placeholder="e.g. Block Resource Centre, Anekal">
                        </div>
                        <div class="form-group">
                            <label for="trainingStatus">Status</label>
                            <select id="trainingStatus">
                                <option value="upcoming">Upcoming</option>
                                <option value="completed">Completed</option>
                                <option value="ongoing">Ongoing</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="trainingAttendees">Number of Attendees</label>
                            <input type="number" id="trainingAttendees" min="0" placeholder="e.g. 25">
                        </div>
                        <div class="form-group">
                            <label for="trainingTarget">Target Group</label>
                            <select id="trainingTarget">
                                <option value="Primary Teachers">Primary Teachers</option>
                                <option value="Upper Primary Teachers">Upper Primary Teachers</option>
                                <option value="Head Masters">Head Masters</option>
                                <option value="CRPs">CRPs</option>
                                <option value="Mixed">Mixed Group</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="trainingNotes">Session Notes</label>
                        <textarea id="trainingNotes" rows="3"
                            placeholder="Key points covered, methodology used, materials shared..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="trainingFeedback">Feedback / Observations</label>
                        <textarea id="trainingFeedback" rows="2"
                            placeholder="Teacher feedback, engagement levels, areas for improvement..."></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-ghost" onclick="closeModal('trainingModal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Training</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Observation Modal -->
    <div class="modal-overlay" id="observationModal">
        <div class="modal">
            <div class="modal-header">
                <h2 id="observationModalTitle"><i class="fas fa-clipboard-check"></i> New Observation</h2>
                <button class="modal-close" onclick="closeModal('observationModal')"><i
                        class="fas fa-times"></i></button>
            </div>
            <form id="observationForm" onsubmit="saveObservation(event)">
                <div class="modal-body">
                    <input type="hidden" id="observationId">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="observationSchool">School Name *</label>
                            <input type="text" id="observationSchool" required
                                placeholder="e.g. Government Primary School, Anekal">
                        </div>
                        <div class="form-group">
                            <label for="observationTeacher">Teacher Name</label>
                            <input type="text" id="observationTeacher" placeholder="e.g. Smt. Lakshmi">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="observationDate">Date *</label>
                            <input type="date" id="observationDate" required>
                        </div>
                        <div class="form-group">
                            <label for="observationClass">Class / Grade</label>
                            <select id="observationClass">
                                <option value="Class 1">Class 1</option>
                                <option value="Class 2">Class 2</option>
                                <option value="Class 3">Class 3</option>
                                <option value="Class 4">Class 4</option>
                                <option value="Class 5">Class 5</option>
                                <option value="Class 6">Class 6</option>
                                <option value="Class 7">Class 7</option>
                                <option value="Class 8">Class 8</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="observationSubject">Subject *</label>
                            <select id="observationSubject" required>
                                <option value="Mathematics">Mathematics</option>
                                <option value="Science">Science</option>
                                <option value="Language">Language</option>
                                <option value="Social Science">Social Science</option>
                                <option value="EVS">EVS</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="observationTopic">Topic Taught</label>
                            <input type="text" id="observationTopic" placeholder="e.g. Fractions, Story Reading">
                        </div>
                    </div>

                    <div class="observation-section">
                        <h3>Classroom Environment</h3>
                        <div class="rating-group">
                            <label>Student Engagement</label>
                            <div class="star-rating" id="ratingEngagement" data-field="engagement">
                                <i class="fas fa-star" data-value="1"></i>
                                <i class="fas fa-star" data-value="2"></i>
                                <i class="fas fa-star" data-value="3"></i>
                                <i class="fas fa-star" data-value="4"></i>
                                <i class="fas fa-star" data-value="5"></i>
                            </div>
                        </div>
                        <div class="rating-group">
                            <label>Teaching Methodology</label>
                            <div class="star-rating" id="ratingMethodology" data-field="methodology">
                                <i class="fas fa-star" data-value="1"></i>
                                <i class="fas fa-star" data-value="2"></i>
                                <i class="fas fa-star" data-value="3"></i>
                                <i class="fas fa-star" data-value="4"></i>
                                <i class="fas fa-star" data-value="5"></i>
                            </div>
                        </div>
                        <div class="rating-group">
                            <label>Use of TLM / Materials</label>
                            <div class="star-rating" id="ratingTLM" data-field="tlm">
                                <i class="fas fa-star" data-value="1"></i>
                                <i class="fas fa-star" data-value="2"></i>
                                <i class="fas fa-star" data-value="3"></i>
                                <i class="fas fa-star" data-value="4"></i>
                                <i class="fas fa-star" data-value="5"></i>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="observationStrengths">Strengths Observed</label>
                        <textarea id="observationStrengths" rows="2"
                            placeholder="What went well in the classroom..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="observationAreas">Areas for Improvement</label>
                        <textarea id="observationAreas" rows="2" placeholder="What could be improved..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="observationSuggestions">Suggestions Given</label>
                        <textarea id="observationSuggestions" rows="2"
                            placeholder="Suggestions provided to the teacher..."></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-ghost" onclick="closeModal('observationModal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Observation</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Resource Modal -->
    <div class="modal-overlay" id="resourceModal">
        <div class="modal modal-sm">
            <div class="modal-header">
                <h2 id="resourceModalTitle"><i class="fas fa-book-open"></i> Add Resource</h2>
                <button class="modal-close" onclick="closeModal('resourceModal')"><i class="fas fa-times"></i></button>
            </div>
            <form id="resourceForm" onsubmit="saveResource(event)">
                <div class="modal-body">
                    <input type="hidden" id="resourceId">
                    <div class="form-group">
                        <label for="resourceTitle">Resource Title *</label>
                        <input type="text" id="resourceTitle" required placeholder="e.g. Fraction Activity Cards">
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="resourceType">Type *</label>
                            <select id="resourceType" required>
                                <option value="Worksheet">Worksheet</option>
                                <option value="Lesson Plan">Lesson Plan</option>
                                <option value="Activity">Activity</option>
                                <option value="Reference">Reference Material</option>
                                <option value="TLM">Teaching-Learning Material</option>
                                <option value="Video">Video</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="resourceSubject">Subject</label>
                            <select id="resourceSubject">
                                <option value="Mathematics">Mathematics</option>
                                <option value="Science">Science</option>
                                <option value="Language">Language</option>
                                <option value="Social Science">Social Science</option>
                                <option value="EVS">EVS</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="resourceGrade">Grade / Class</label>
                            <input type="text" id="resourceGrade" placeholder="e.g. Class 3-5">
                        </div>
                        <div class="form-group">
                            <label for="resourceSource">Source</label>
                            <input type="text" id="resourceSource" placeholder="e.g. APF, NCERT, Self-created">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="resourceDescription">Description</label>
                        <textarea id="resourceDescription" rows="3"
                            placeholder="Brief description of this resource, how to use it..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="resourceTags">Tags (comma-separated)</label>
                        <input type="text" id="resourceTags" placeholder="e.g. fractions, hands-on, group activity">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-ghost" onclick="closeModal('resourceModal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Resource</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Quick Add Modal -->
    <div class="modal-overlay" id="quickAddModal">
        <div class="modal modal-sm">
            <div class="modal-header">
                <h2><i class="fas fa-plus-circle"></i> Quick Add</h2>
                <button class="modal-close" onclick="closeModal('quickAddModal')"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body quick-add-body">
                <button class="quick-add-btn" onclick="closeModal('quickAddModal'); openVisitModal()">
                    <i class="fas fa-school"></i>
                    <span>School Visit</span>
                </button>
                <button class="quick-add-btn" onclick="closeModal('quickAddModal'); openTrainingModal()">
                    <i class="fas fa-chalkboard-teacher"></i>
                    <span>Training Session</span>
                </button>
                <button class="quick-add-btn" onclick="closeModal('quickAddModal'); openObservationModal()">
                    <i class="fas fa-clipboard-check"></i>
                    <span>Observation</span>
                </button>
                <button class="quick-add-btn" onclick="closeModal('quickAddModal'); openResourceModal()">
                    <i class="fas fa-book-open"></i>
                    <span>Resource</span>
                </button>
                <button class="quick-add-btn" onclick="closeModal('quickAddModal'); openIdeaModal()">
                    <i class="fas fa-lightbulb"></i>
                    <span>New Idea</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Reflection Modal -->
    <div class="modal-overlay" id="reflectionModal">
        <div class="modal">
            <div class="modal-header">
                <h2 id="reflectionModalTitle"><i class="fas fa-journal-whills"></i> New Reflection</h2>
                <button class="modal-close" onclick="closeModal('reflectionModal')"><i class="fas fa-times"></i></button>
            </div>
            <form id="reflectionForm" onsubmit="saveReflection(event)">
                <div class="modal-body">
                    <input type="hidden" id="reflectionId">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="reflectionMonth">Month *</label>
                            <input type="month" id="reflectionMonth" required>
                        </div>
                        <div class="form-group">
                            <label for="reflectionMood">Overall Feeling</label>
                            <select id="reflectionMood">
                                <option value="great">üòä Great ‚Äî productive month</option>
                                <option value="good">üôÇ Good ‚Äî steady progress</option>
                                <option value="okay">üòê Okay ‚Äî mixed results</option>
                                <option value="challenging">üòü Challenging ‚Äî tough month</option>
                                <option value="difficult">üòî Difficult ‚Äî need support</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="reflectionWentWell"><i class="fas fa-check-circle" style="color:#10b981;"></i> What went well this month?</label>
                        <textarea id="reflectionWentWell" rows="3" placeholder="Successful activities, positive teacher/student interactions, breakthroughs..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="reflectionChallenges"><i class="fas fa-exclamation-circle" style="color:#ef4444;"></i> What challenges did you face?</label>
                        <textarea id="reflectionChallenges" rows="3" placeholder="Difficulties in schools, teacher resistance, time management, travel issues..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="reflectionLearnings"><i class="fas fa-brain" style="color:#8b5cf6;"></i> Key learnings & insights</label>
                        <textarea id="reflectionLearnings" rows="3" placeholder="What did you learn about teaching, learning, or your own practice?"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="reflectionNextSteps"><i class="fas fa-arrow-right" style="color:#3b82f6;"></i> Plans for next month</label>
                        <textarea id="reflectionNextSteps" rows="3" placeholder="Focus areas, schools to visit, trainings to conduct, goals..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="reflectionGratitude"><i class="fas fa-heart" style="color:#ec4899;"></i> Gratitude / Highlight</label>
                        <textarea id="reflectionGratitude" rows="2" placeholder="A moment that made your work feel meaningful..."></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-ghost" onclick="closeModal('reflectionModal')">Cancel</button>
                    <button type="submit" class="btn btn-primary"><i class="fas fa-save"></i> Save Reflection</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Contact Modal -->
    <div class="modal-overlay" id="contactModal">
        <div class="modal modal-sm">
            <div class="modal-header">
                <h2 id="contactModalTitle"><i class="fas fa-address-book"></i> Add Contact</h2>
                <button class="modal-close" onclick="closeModal('contactModal')"><i class="fas fa-times"></i></button>
            </div>
            <form id="contactForm" onsubmit="saveContact(event)">
                <div class="modal-body">
                    <input type="hidden" id="contactId">
                    <div class="form-group">
                        <label for="contactName">Name *</label>
                        <input type="text" id="contactName" required placeholder="e.g. Smt. Lakshmi">
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="contactRole">Role *</label>
                            <select id="contactRole" required>
                                <option value="Head Master">Head Master</option>
                                <option value="Teacher">Teacher</option>
                                <option value="BEO">BEO</option>
                                <option value="DIET Faculty">DIET Faculty</option>
                                <option value="CRP">CRP</option>
                                <option value="Fellow RP">Fellow RP</option>
                                <option value="Mentor">Mentor</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="contactSchool">School / Organization</label>
                            <input type="text" id="contactSchool" placeholder="e.g. GPS Anekal">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="contactPhone">Phone</label>
                            <input type="tel" id="contactPhone" placeholder="e.g. 9876543210">
                        </div>
                        <div class="form-group">
                            <label for="contactEmail">Email</label>
                            <input type="email" id="contactEmail" placeholder="e.g. name@email.com">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="contactBlock">Block / District</label>
                        <input type="text" id="contactBlock" placeholder="e.g. Anekal Block">
                    </div>
                    <div class="form-group">
                        <label for="contactNotes">Notes</label>
                        <textarea id="contactNotes" rows="2" placeholder="Any important details about this contact..."></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-ghost" onclick="closeModal('contactModal')">Cancel</button>
                    <button type="submit" class="btn btn-primary"><i class="fas fa-save"></i> Save Contact</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Idea Modal -->
    <div class="modal-overlay" id="ideaModal">
        <div class="modal">
            <div class="modal-header">
                <h2 id="ideaModalTitle"><i class="fas fa-lightbulb"></i> New Idea</h2>
                <button class="modal-close" onclick="closeModal('ideaModal')"><i class="fas fa-times"></i></button>
            </div>
            <form id="ideaForm" onsubmit="saveIdea(event)">
                <div class="modal-body">
                    <input type="hidden" id="ideaId">
                    <div class="form-group">
                        <label for="ideaTitle">Idea Title *</label>
                        <input type="text" id="ideaTitle" required placeholder="Give your idea a catchy name...">
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="ideaCategory">Category</label>
                            <select id="ideaCategory">
                                <option value="Teaching">üéì Teaching</option>
                                <option value="Activity">üé® Activity</option>
                                <option value="Training">üìã Training</option>
                                <option value="Resource">üìö Resource</option>
                                <option value="Community">ü§ù Community</option>
                                <option value="Tech">üíª Tech</option>
                                <option value="Other">üí° Other</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="ideaStatus">Status</label>
                            <select id="ideaStatus">
                                <option value="spark">‚ú® Spark</option>
                                <option value="exploring">üîç Exploring</option>
                                <option value="in-progress">üöÄ In Progress</option>
                                <option value="done">‚úÖ Done</option>
                                <option value="archived">üì¶ Archived</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="ideaPriority">Priority</label>
                            <select id="ideaPriority">
                                <option value="low">üü¢ Low</option>
                                <option value="medium" selected>üü° Medium</option>
                                <option value="high">üî¥ High</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="ideaColor">Color Label</label>
                            <div class="idea-color-picker" id="ideaColorPicker">
                                <span class="color-dot active" data-color="#f59e0b" style="background:#f59e0b" onclick="pickIdeaColor(this)"></span>
                                <span class="color-dot" data-color="#ef4444" style="background:#ef4444" onclick="pickIdeaColor(this)"></span>
                                <span class="color-dot" data-color="#8b5cf6" style="background:#8b5cf6" onclick="pickIdeaColor(this)"></span>
                                <span class="color-dot" data-color="#3b82f6" style="background:#3b82f6" onclick="pickIdeaColor(this)"></span>
                                <span class="color-dot" data-color="#10b981" style="background:#10b981" onclick="pickIdeaColor(this)"></span>
                                <span class="color-dot" data-color="#ec4899" style="background:#ec4899" onclick="pickIdeaColor(this)"></span>
                                <span class="color-dot" data-color="#f97316" style="background:#f97316" onclick="pickIdeaColor(this)"></span>
                                <span class="color-dot" data-color="#06b6d4" style="background:#06b6d4" onclick="pickIdeaColor(this)"></span>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="ideaDescription">Description</label>
                        <textarea id="ideaDescription" rows="4" placeholder="Describe your idea in detail ‚Äî what, why, how..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="ideaTags">Tags (comma-separated)</label>
                        <input type="text" id="ideaTags" placeholder="e.g. math, hands-on, innovative, class-3">
                    </div>
                    <div class="form-group">
                        <label for="ideaInspiration">Inspiration / Source</label>
                        <input type="text" id="ideaInspiration" placeholder="Where did this idea come from?">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-ghost" onclick="closeModal('ideaModal')">Cancel</button>
                    <button type="submit" class="btn btn-primary"><i class="fas fa-save"></i> Save Idea</button>
                </div>
            </form>
        </div>
    </div>

    <script src="app.js"></script>
    <script src="excel-analytics.js"></script>
</body>

</html>